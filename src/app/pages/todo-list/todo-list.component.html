<button mat-button #createButton (click)="createButton.disabled = true">New Todo</button>
@if (createButton.disabled) {
  <textarea #newTodoText style="background: black; color: white"></textarea>
  <button mat-button (click)="createButton.disabled = false; createTodo(newTodoText.value)">Create</button>
}
<table mat-table [dataSource]="todos" class="mat-elevation-z8">

  <ng-container matColumnDef="todos">
    <th mat-header-cell *matHeaderCellDef> Todo </th>
    <td mat-cell *matCellDef="let todo">
      <textarea #textAreaElement style="background: black; color: white; width: 100%" disabled>{{ todo.task }}</textarea>
      @if (!textAreaElement.disabled) {
        <button mat-button (click)="updateTodo(todo, textAreaElement)">Save</button>
      }
      <p>{{ todo.status  == Status.IN_PROGRESS ? 'In progress' : 'Done'}}</p>
      <p>{{ todo.date | date: 'dd.MM.yyyy, HH:mm'}}</p>
      @if (todo.status !== Status.DONE) {
        <button mat-button (click)="updateStatus(todo)" [disabled]="todo.status == Status.DONE">
          Mark as done
        </button>
      }
      @if (textAreaElement.disabled) {
        <button mat-button (click)="textAreaElement.disabled = false">Edit</button>
      }
      <button mat-button (click)="deleteTodo(todo.id)">Delete</button>
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="['todos']"></tr>
  <tr mat-row *matRowDef="let row; columns: ['todos'];"></tr>
</table>
